language: node_js

node_js:
  - 7.4.0

branches:
  only:
    - master

before_deploy:
  - terraform_url=$(curl https://releases.hashicorp.com/index.json | jq '{terraform}' | egrep "linux.*amd64" | sort --version-sort -r | head -1 | awk -F[\"] '{print $4}')
  - curl -o terraform.zip $terraform_url
  - sudo unzip terraform.zip -d /opt/terraform
  - sudo ln -s /opt/terraform/terraform /usr/bin/terraform
  - rm -f terraform.zip

deploy:
  provider: script
  script: make deploy
  on:
    branch: master

env:
  global:
    - secure: gcXWM40w9l6Nc+aIsDV4O512+MsImuMyd+KHXDFS3KVZzzWNIt75AkKCqgRdpQIpBqHFAwkV3G2mUQo0LgmIVEhKHdSKpyPE4flzGRKrf0zIlQVLP8zRf2eFqpKKSHTPXACDXaqyATHF70DPPv6TqE0oIEhYjVOmLjgLxUuYefAuABCqenghn/+hLGb5FnxmKtC6/COT6beBnqItzWpchcE92qxSPG7XdqjVbxXmxAe8XZxymXB/iG/CW7KkUAr/MiuMne9L7Wt/I7PE5AtRmSX6x8f2SPDvNxKRv7vic/PdPlOO3iAcYGfCcEtIlRwlXH6wYY43H6ZfRNquI/5Z4kZxSLexaFWu6q2V9fG9i6vsc6VoIiGqY0woBrlMco+5CdEw2f2DLjWV2+st3+E6EGw/VPOnbwRUbGOgHSXq/8RizTuU4LGAulFCuRN72ORG4xbT7VX2qJfNmJuJEau9Orz94QFkSQbcE9hAys8Tj4+BkYnCvCvcOw98bziTSlpNEP3OYWnuyFUi+8VqRpnM/2pMe/yz9ocAoEnBq1bH+WZNMXIelsJESSARfqBaEue+THffOiIYrM1cqca4vdVBRRWMY95ChTPAde/rt7HtSUvySVJ1LuYeRdUjND8f/rChma5o4o3P8l1qQp/OOfCyay++ya6AO1mskXIcphFsY7s=
    - secure: lj30p8amffWWQK43SGoLAilZGRb4H/h1Y0bqIJsCxtVYweOCGetM95r7XgFlY/p4kmDJzySTzufw3lNIwRju9E3VOWuMQIxN15d8E4Rf2p756PTRIz4apsvSjfxhnbFhap/rzb6u426d51PkeXzqF0pBLFDQiE18uMl5eqgTJncQsCPnUkRq8LIJJFmKaH37Qd7I6E2ymESY0VBAuMSTLWV5EMYfTCNXvk9nIVrSZ7pst/aJKHSZugESciiduk3Q3NZfgFhS0ALTB330HVeCCbVCJOM/ZAJtjY/tSjesMGD4Jk/OgObeJ5AG1ELCgHFuE0OdMjkCoggH2y9hfXJbRZ4E4bvUp9hZCkFp5BnFxZcIzANiGYWKfxJ1F6mcK4CkgJexIrB9ooOOHZTJb6hBF/pqWU+QFZ+AJsKhCKHX+GwZcYyPrxKrFEfeBAHXPdcp25zEbYYvQglUMnUu2+I10dRM/M8XgKCaF8QQobrA9Id+i/pnCEB81SznhUdsTIzf/q6hLSZaE6ifsW7DpjkGpx959ytGRp+qrSS/QFEY213f0VGnMUSV2c6cOy3DYPbNqGqPhBf2ZKARkmxD3lTSCoqGYlbIiHFbJpHIMsuT7b5qFQBUbLJQJs+K0aN7JeigooW9kI8mdl/bGjkN3CB5p43xXPftcQg0X9Iq+/BSMLE=
