language: node_js

node_js:
  - 7.4.0

branches:
  only:
    - master

before_deploy:
  - terraform_url=$(curl https://releases.hashicorp.com/index.json | jq '{terraform}' | egrep "linux.*amd64" | sort --version-sort -r | head -1 | awk -F[\"] '{print $4}')
  - curl -o terraform.zip $terraform_url
  - sudo unzip terraform.zip -d /opt/terraform
  - sudo ln -s /opt/terraform/terraform /usr/bin/terraform
  - rm -f terraform.zip

deploy:
  provider: script
  script: make deploy
  on:
    branch: master

env:
  global:
    - secure: L+7/0HNckjMTau2rv8xqzw/4LT94dIbkyMQ6ADPBzuKrklFeM3rrJPwhYOGXU7M90YuKy4XQJx6fAcN7UOhzezfDS03YJjVso3ITcXtLdkEh1PQ1QHkyfXFy8dO6ufpvDezuCBTYazJl/CygmagU39m0hFcIdMa/FWK+Hhj/rF4HUj5a73MMxoOJL3VQQRLHvNgjFsjj07dkcedd1l9eEngDj5YjPV6Ba5dw1ychboVQL6ad6zUhZznhgX1yeNyBbICnbQcnPlN6UXRpOic0nApk5kGMkM6zqRed8KhYjFo8PtFl0vXAjnPQkkxBgRTsedf6mIq5fnDNmXowRlHsksgJ0p7fvNIDNMXG6kVbZUwkMvqCG8XG94d/nM73AEMD/UdxNSDRQjCWwPjyce3eA9br4fg5WjDFaOHT27xNtchuMhvPEfHg4ZF4FiIK8rbMXqxJY7TlXOdgVx8pVKR/fvWXkIzcsY7hiZZN3fIJnb3kmUKhy2wFg4D6tAcnoPCuqgVdZU9EMiHkTC3bwF8bqAP5sKuBXavDW2n3wRKmvazqwBGZbCHyR3A/xP3Yj95IsX2Aio/VAmJBs3mIbHuy9YX+o72FmDS5suvpYFTfltvokIYXgmM7eLN3Dh9sgeA2d3D67zKw8enwv5MfnKAhYCNlkPxtHLhvUuIJvAOPDGE=
    - secure: o+7kgfimrHy/M+FNVKM+wtB4h4UsphAWw3oWDhvN5RoXi4v92TKGLYdD+5D3FdmyBgmbvdFl5FwTMvf2tXQQTG1LYLQCb/Pbzdt9KdAdEAZ32vOgVOaO5cu5JOkJTubjNtN6aPWubi+KxN5c3wxFEJrTUKmZH7H9AQXm5nEZb5dy4D0UiI6r3yNVeHNGAr5w61TRlaqK0IhkVfeOlDdZh9i/31LLsyBoh9Q3enSd/JbYj8yoDuIZMZzTE5bdGkHsGKbX8s5XRc7Nyxis/ttbRM7zj/3ZmVC6xZkGWNirwb9EcnmifZznDrd45N9r8qRX2DKZwl7bSy7oD796gfOSVQ6ZmFl3jPC6H0+6qt9FuaT/JPLhjfTuPTZO1RGmyOra4S9JWU5LzG1BjjcPqudt2aDQZBymiPKMhNzlpNuIlexaj4bWO14TUPyWs7Q3Q83do2dlcSGi+xoYcBNdu6YMKMe4k+qzwu2saGDA3nkM6+3RIoLFVc3DxGzpCNsy+sbyOXJZz2fiOVg3iH2tixHGjOKhXP6GtOWl26iVfkLFhH3TbjfTMxQDnKizJN/T5bZemlr/atVX49Q764jZgLvcsFoseqt7DImfiDMeExTGxgdfbF28uE57N5lxgHdnP4njxlI4N7et2bdOxPVLPKu7xerNstfHavGcy8LY2NC1sf4=
